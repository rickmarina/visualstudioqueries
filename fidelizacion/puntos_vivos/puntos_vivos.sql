USE CF_DISA

/* Ptos. vivos CBSMA socios ACTIVOS */
/* QUERY 1 */

SELECT     
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1002','1080','1081','1083') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CEUTA',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_MELILLA',
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) not in ('1','4') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_PENINSULA',  
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) in ('1','4') and TCF40.CL_CENTRO_HAB not in ('1002','1080','1081','1083','1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CANARIAS',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB is null OR TCF40.CL_CENTRO_HAB = '' THEN TCF42.SALDO_PUNTOS END) as 'PTOS_SINEESS_ASIGNADA'  
--COUNT(*) AS CLIENTES, 
--SUM(TCF42.SALDO_PUNTOS) AS TOT_SALDO, 
FROM         TCF42 INNER JOIN   
                      TCF40 ON TCF42.CL_CLIENTE = TCF40.CL_CLIENTE   
					  	inner join tcf41 on tcf41.id_cuenta = tcf42.id_cuenta and tcf41.cl_cliente = tcf42.cl_cliente  
WHERE     (TCF42.TIPO_CUENTA = 'FI')   
AND (LEFT(tcf41.cl_tarjeta,6) = '700421')  
and (TCF42.ESTADO = '1')  
and (tcf42.estado is not null)  
and (Tcf41.estado in (1,2))  


/* QUERY 2 */
/* Ptos. vivos CBSMA socios BLOQUEADOS */
SELECT     
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1002','1080','1081','1083') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CEUTA', 
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_MELILLA', 
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) not in ('1','4') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_PENINSULA', 
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) in ('1','4') and TCF40.CL_CENTRO_HAB not in ('1002','1080','1081','1083','1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CANARIAS',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB is null OR TCF40.CL_CENTRO_HAB = '' THEN TCF42.SALDO_PUNTOS END) as 'PTOS_SINEESS_ASIGNADA' 
--COUNT(*) AS CLIENTES, 
--SUM(TCF42.SALDO_PUNTOS) AS TOT_SALDO, 
FROM         TCF42 INNER JOIN 
                      TCF40 ON TCF42.CL_CLIENTE = TCF40.CL_CLIENTE 
					  	inner join tcf41 on tcf41.id_cuenta = tcf42.id_cuenta and tcf41.cl_cliente = tcf42.cl_cliente
WHERE     (TCF42.TIPO_CUENTA = 'FI') 
AND (LEFT(tcf41.cl_tarjeta,6) = '700421')
and (TCF42.ESTADO = '3') 
and (tcf42.estado is not null) 
and (Tcf41.estado in (1,2)) 

------- Tu Club DISA ------------------------

/* QUERY 3 */
/* Ptos. vivos Tu Club DISA socios ACTIVOS */
SELECT     
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1002','1080','1081','1083') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CEUTA',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_MELILLA',
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) not in ('1','4') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_PENINSULA',
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) in ('1','4') and TCF40.CL_CENTRO_HAB not in ('1002','1080','1081','1083','1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CANARIAS',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB is null OR TCF40.CL_CENTRO_HAB = '' THEN TCF42.SALDO_PUNTOS END) as 'PTOS_SINEESS_ASIGNADA'
FROM         TCF42 INNER JOIN 
                      TCF40 ON TCF42.CL_CLIENTE = TCF40.CL_CLIENTE 
					  	inner join tcf41 on tcf41.id_cuenta = tcf42.id_cuenta and tcf41.cl_cliente = tcf42.cl_cliente
WHERE     (TCF42.TIPO_CUENTA = 'FI') 
AND left(tcf41.cl_tarjeta,9) = '972400077'
and (TCF42.ESTADO = '1') 
and (tcf42.estado is not null) 
and (Tcf41.estado in (1,2))

/* QUERY 4 */
/* Ptos. vivos Tu Club DISA socios BLOQUEADOS */
SELECT     
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1002','1080','1081','1083') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CEUTA',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB in ('1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_MELILLA',
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) not in ('1','4') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_PENINSULA',
SUM(CASE WHEN left(TCF40.CL_CENTRO_HAB,1) in ('1','4') and TCF40.CL_CENTRO_HAB not in ('1002','1080','1081','1083','1039','1040','1041','1042','1043','1044','1045') THEN TCF42.SALDO_PUNTOS END) as 'PTOS_CANARIAS',
SUM(CASE WHEN TCF40.CL_CENTRO_HAB is null OR TCF40.CL_CENTRO_HAB = '' THEN TCF42.SALDO_PUNTOS END) as 'PTOS_SINEESS_ASIGNADA'
FROM         TCF42 INNER JOIN 
                      TCF40 ON TCF42.CL_CLIENTE = TCF40.CL_CLIENTE 
					  	inner join tcf41 on tcf41.id_cuenta = tcf42.id_cuenta and tcf41.cl_cliente = tcf42.cl_cliente
WHERE     (TCF42.TIPO_CUENTA = 'FI') 
AND left(tcf41.cl_tarjeta,9) = '972400077'
and (TCF42.ESTADO = '3') 
and (tcf42.estado is not null) 
and (Tcf41.estado in (1,2)) 






